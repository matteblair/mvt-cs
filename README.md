# MVT-CS

### What?

This is a proof-of-concept program to demonstrate how files in the [MVT (version 1) format](https://github.com/mapbox/vector-tile-spec) can be parsed in C# using the standard protocol buffer code generator.

To compile and run the program you'll need [dotnet core](https://www.microsoft.com/net/core).

### How?

Load and print the contents of `./tile.mvt`:
```
dotnet run
```

Load and print the contents of other MVT files:
```
dotnet run other.mvt files.mvt
```

To (re)generate the C# code used to parse the protocol buffer:

  1. Download the latest compiled release of `protoc` and put the files in `./protoc-3/`

  2. Run `protoc` on the `.proto` file:
    ```
    ./protoc-3/bin/protoc --proto_path=./protoc-3/include/ --proto_path=. --csharp_out=. ./mvt.proto
    ```

### Why?

The [Protobuf](https://github.com/google/protobuf) project has somewhat recently added support for C# code generation, enabling dead-simple usage of protocol buffers in any C# project. However, the C# generator [only supports version 3](https://github.com/google/protobuf/blob/master/csharp/README.md#history-of-c-protobufs) of the protocol buffer language, and the MVT specification `.proto` file uses version 2 of the language. Fortunately, the protocol buffers produced by versions 2 and 3 of the language are similar enough that they can be trated interchangably if the `.proto` files are carefully crafted.

The `mvt.proto` in this repository is a translation of the MVT specification from version 2 to version 3 of the protocol buffer language. The code generated by this `.proto` is able to read protocol buffers produced using the official MVT `.proto` that uses language version 2.
